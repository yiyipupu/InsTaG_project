<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>è§†é¢‘ç”Ÿæˆç•Œé¢</title>
  <!-- å¼•å…¥æ‰‹å†™ä½“å­—ä½“ -->
  <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+QingKe+HuangYou&family=Long+Cang&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/abstract/style.css') }}">

</head>

<body id="pageBody" class="subpage-bg">
  <!-- æŠ½è±¡èƒŒæ™¯æ–‡å­—å±‚ -->
  <div class="abstract-bg">
    <div class="bg-text">æŠ½è±¡</div>
    <div class="bg-text">AIåœ¨æ‹å°è§†é¢‘</div>
    <div class="bg-text">è§†é¢‘æ¸²æŸ“ä¸­</div>
    <div class="bg-text">åˆ«æ€¥ åœ¨Päº†</div>
    <div class="bg-text">GPUåœ¨å†’çƒŸ</div>
    <div class="bg-text">è¿™ä¸ªAIä¼šæ¼”æˆ</div>
    <div class="bg-text">å˜´å‹å¯¹ä¸ä¸Š</div>
    <div class="bg-text">é‡æ¥ä¸€é</div>
    <div class="bg-text">æ­£åœ¨å¯¹å£å‹</div>
    <div class="bg-text">é©¬ä¸Šå°±å¥½</div>
  </div>
  
  <header class="subpage-header">
    <button class="back-btn" onclick="history.go(-1)">
      â† ä¸ç©äº†
    </button>
    <h2>è§†é¢‘ç”Ÿæˆç•Œé¢</h2>
  </header>

  <main class="video-page-container">
    <section class="video-display">
      <div class="video-label">ğŸ¬ ç…ç…AIæ‹çš„å°è§†é¢‘</div>
      <video id="outputVideo" controls>
      </video>
      <div class="funny-note">æ¸©é¦¨æç¤ºï¼šå¦‚æœå˜´å‹å¯¹ä¸ä¸Šï¼Œå¯èƒ½æ˜¯AIæ²¡å­¦å¥½</div>
      <div class="video-stats">
        <div class="stat-item">ğŸ“Š è§†é¢‘è´¨é‡ï¼š<span class="stat-value">æŠ½è±¡çº§</span></div>
        <div class="stat-item">ğŸ­ æ¼”æŠ€è¯„åˆ†ï¼š<span class="stat-value">7.8/10</span></div>
        <div class="stat-item">ğŸ‘„ å£å‹åŒ¹é…ï¼š<span class="stat-value">å‹‰å¼ºèƒ½çœ‹</span></div>
      </div>
    </section>

    <section class="form-section">
      <form id="videoForm">
        <div class="form-group">
          <label>é€‰ä¸ªAIæ¼”å‘˜</label>
         <select name="model_name">
                    <option value="InsTaG">InsTaG</option>
                </select>
          <div class="hint">ä¸åŒæ¼”å‘˜æœ‰ä¸åŒæ¼”æŠ€ï¼Œè´µçš„å¯èƒ½æ›´ä¼šæ¼”</div>
        </div>

        <div class="form-group">
          <label>AIçš„å®¶åœ¨å“ªé‡Œ</label>
          <input type="text" name="model_param" placeholder="è¯·è¾“å…¥æ¨¡å‹ç›®å½•è·¯å¾„">
          <div class="hint">å°±æ˜¯ä¹‹å‰è®­ç»ƒå¥½çš„æ¨¡å‹æ”¾å“ªå„¿äº†</div>
        </div>

        <div class="form-group">
          <label>ç»™AIå¬å¬è¿™ä¸ªå£°éŸ³</label>
         <input type="text" name="ref_audio" placeholder="è¯·è¾“å…¥éŸ³é¢‘è·¯å¾„">
          <div class="hint">AIä¼šæ ¹æ®è¿™ä¸ªå£°éŸ³æ¥å¯¹å£å‹</div>
        </div>

        <div class="form-group">
          <label>ç”¨å“ªä¸ªæ˜¾å¡è·‘</label>
          <select name="gpu_choice">
            <option value="GPU0">GPU 0ï¼ˆè€é»„å®¶çš„ï¼‰</option>
            <option value="GPU1">GPU 1ï¼ˆè‹å¦ˆå®¶çš„ï¼‰</option>
            <option>æˆ‘çš„æ‰‹æœºï¼ˆå¼€ç©ç¬‘çš„ï¼‰</option>
          </select>
          <div class="hint">æ˜¾å¡è¶Šå¥½ï¼ŒAIæ¼”æˆè¶Šå¿«</div>
        </div>

        <div class="form-group">
            <label>ğŸ—£ï¸ è®©AIè¯´è¿™äº›è¯</label>
            <textarea name="target_text" placeholder=""></textarea>
            <div class="hint">å†™ç‚¹äººè¯</div>
        </div>
        
        <div>
          <button class="generate-btn" type="submit">å¼€å§‹æ‹ç‰‡ï¼</button>
        </div>
      </form>
    </section>
  </main>

  <script>
  const skin = localStorage.getItem('skin') || 'dark-theme';
  document.getElementById('pageBody').classList.add(skin);
  const videoEl = document.getElementById('outputVideo');

  // æç¬‘è¯­å½•
  const videoQuotes = [
    "æ­£åœ¨ç»™AIç”»å£çº¢...",
    "AIï¼šè¿™æ®µå°è¯è°å†™çš„ï¼Ÿ",
    "å˜´å‹è®¡ç®—ä¸­ï¼Œæ„Ÿè§‰è¦å˜´ç“¢",
    "AIåœ¨ç»ƒä¹ è¡¨æƒ…ç®¡ç†",
    "è¿™æ®µè¡¨æ¼”éœ€è¦åŠ ç‚¹æ„Ÿæƒ…",
    "AIè¦æ±‚åŠ é¸¡è…¿",
    "æ¸²æŸ“åˆ°ä¸€åŠï¼ŒAIæƒ³å»å•æ‰€",
    "è¿™æ®µæ¼”æŠ€å¯ä»¥æ‹¿å¥¥æ–¯å¡...æå",
    "AIï¼šå¯¼æ¼”ï¼Œèƒ½é‡æ¥ä¸€éå—ï¼Ÿ",
    "ç»ˆäºå¯¹å£å‹æˆåŠŸäº†ï¼",
    "AIå·å·æ”¹å‰§æœ¬",
    "è¿™æ®µè¡¨æ¼”è¿‡äºæµ®å¤¸",
    "AIè§‰å¾—è‡ªå·±æ˜¯å½±å¸",
    "å˜´å‹ç»ˆäºå¯¹ä¸Šäº†ï¼æ„ŸåŠ¨",
    "AIè¦æ±‚ç”¨æ›¿èº«"
  ];

  // è§†é¢‘ç”ŸæˆçŠ¶æ€
  const videoStatus = {
    0: "AIæ¼”å‘˜æ­£åœ¨åŒ–å¦†",
    10: "AIåœ¨èƒŒå°è¯",
    25: "AIç»ƒä¹ è¡¨æƒ…ä¸­",
    40: "ç¬¬ä¸€é•œæ‹æ‘„",
    55: "å¯¼æ¼”å–Šå¡ï¼Œé‡æ¥",
    70: "å¯¹å£å‹ç»ƒä¹ ",
    85: "æœ€ç»ˆæ‹æ‘„",
    95: "åæœŸæ¸²æŸ“",
    100: "æ€é’ï¼æˆç‰‡å®Œæˆ"
  };

  // è§†é¢‘å‚æ•°æ¨¡æ‹Ÿï¼ˆå¦‚æœä¸éœ€è¦ä¹Ÿå¯ä»¥åˆ æ‰ï¼‰
const fpsValues = [24, 25, 30, 60];
const durationValues = [3, 5, 8, 10, 15];
const performanceStates = ["åˆ’æ°´ä¸­", "åŠªåŠ›æ¼”", "æ¼”æŠ€çˆ†å‘", "éœ€è¦æŒ‡å¯¼", "æ¸å…¥ä½³å¢ƒ", "å®Œç¾æ¼”ç»"];

document.getElementById('videoForm').addEventListener('submit', e => {
  e.preventDefault();

  const formData = new FormData(e.target);

  // â­ ç›´æ¥å‘èµ·åç«¯è¯·æ±‚ï¼ˆæ— è¿›åº¦æ¡ï¼‰
  fetch('/video_generation', {
    method: 'POST',
    body: formData
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === 'success') {

      // â­ æ›´æ–°è§†é¢‘
      videoEl.src = data.video_path + '?t=' + Date.now();
      videoEl.load();

      // â­ å¼¹å‡ºå®Œæˆæç¤º
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.innerHTML = 'ğŸ‰ <strong>è§†é¢‘ç”Ÿæˆå®Œæˆï¼</strong><br>AIçš„å°ä½œå“å·²ç»å‡†å¤‡å¥½äº†ï¼';
      notification.style.position = 'fixed';
      notification.style.top = '100px';
      notification.style.left = '50%';
      notification.style.transform = 'translateX(-50%)';
      notification.style.zIndex = '9999';
      notification.style.textAlign = 'center';
      document.body.appendChild(notification);

      setTimeout(() => notification.classList.add('show'), 10);
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => document.body.removeChild(notification), 300);
      }, 3000);

    } else {
      alert("âŒ è§†é¢‘ç”Ÿæˆå¤±è´¥ï¼š" + (data.msg || "æœªçŸ¥é”™è¯¯"));
    }
  })
  .catch(err => {
    console.error(err);
    alert("âŒ è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡");
  });
});

// ======================
// è§†é¢‘æ’­æ”¾äº¤äº’ï¼ˆä¿ç•™ï¼‰
// ======================
videoEl.addEventListener('play', () => {
  document.querySelector('.video-label').textContent = 'ğŸ¬ AIæ­£åœ¨ç°åœºç›´æ’­ï¼';
  document.querySelector('.funny-note').textContent = 'æ¸©é¦¨æç¤ºï¼šå¦‚æœå˜´å‹æ€ªå¼‚ï¼Œè¯·å¤šåŒ…æ¶µï¼ŒAIå°½åŠ›äº†';
});

videoEl.addEventListener('pause', () => {
  document.querySelector('.video-label').textContent = 'ğŸ¬ AIä¸­åœºä¼‘æ¯';
});

videoEl.addEventListener('ended', () => {
  document.querySelector('.video-label').textContent = 'ğŸ¬ AIæ¼”å‡ºç»“æŸï¼Œè°¢è°¢è§‚çœ‹ï¼';
  setTimeout(() => {
    document.querySelector('.video-label').textContent = 'ğŸ¬ ç…ç…AIæ‹çš„å°è§†é¢‘';
  }, 2000);
});

// è¡¨å•å…ƒç´ äº¤äº’æ•ˆæœï¼ˆä¿ç•™ï¼‰
document.querySelectorAll('select, input, textarea').forEach(element => {
  element.addEventListener('focus', () => {
    element.style.transform = 'rotate(1.5deg) translateY(-3px)';
    element.style.boxShadow = '0 5px 15px var(--shadow)';
  });
  
  element.addEventListener('blur', () => {
    element.style.transform = 'rotate(-0.5deg) translateY(0)';
    element.style.boxShadow = 'inset 0 3px 6px rgba(0, 0, 0, 0.1)';
  });
});

</script>
  
  <style>
    /* è§†é¢‘ç»Ÿè®¡ä¿¡æ¯ */
    .video-stats {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 15px;
      border: 2px dashed var(--border);
      transform: rotate(1deg);
    }
    
    .stat-item {
      font-size: 1rem;
      color: var(--text);
      font-weight: bold;
    }
    
    .stat-value {
      color: var(--accent);
      font-family: 'Ma Shan Zheng', cursive;
    }
    
    /* è§†é¢‘å‚æ•°æ˜¾ç¤º */
    .video-params {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      border: 1px solid var(--border);
      transform: rotate(-0.5deg);
    }
    
    .param-item {
      font-size: 0.95rem;
      color: var(--text-secondary);
    }
    
    .param-item span {
      color: var(--primary);
      font-weight: bold;
    }
  </style>
</body>
</html>